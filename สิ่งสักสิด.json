{
  "name": "สิ่งสักสิด",
  "nodes": [
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.formTrigger",
      "typeVersion": 2.3,
      "position": [
        -80,
        -272
      ],
      "id": "ea65693f-8ba4-48ff-b043-b02ce120aa46",
      "name": "On form submission",
      "webhookId": "432c982d-6af8-45bf-80f3-3120f5151f55"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "mode": "list",
          "value": ""
        },
        "sheetName": {
          "__rl": true,
          "mode": "list",
          "value": ""
        }
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        160,
        -272
      ],
      "id": "a9e4df65-706c-469f-8cad-859d0837cfa9",
      "name": "Get row(s) in sheet",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "uyTjJuwscBcWz4hf",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "d7274587-c704-44a3-87b1-a1ed09604f94",
              "leftValue": "",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        384,
        -272
      ],
      "id": "dea6d20e-7bcc-4a58-b471-301ece68df88",
      "name": "If"
    },
    {
      "parameters": {
        "operation": "sendAndWait",
        "options": {}
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        656,
        -400
      ],
      "id": "6ee3768a-58ca-4b22-bfd7-008e1008dff9",
      "name": "Send message and wait for response",
      "webhookId": "65334137-547c-4db1-b531-71013bf4cbc4",
      "credentials": {
        "gmailOAuth2": {
          "id": "DhSw4HHChVkjzWdk",
          "name": "Gmail account"
        }
      }
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        624,
        16
      ],
      "id": "6a6ee5d4-2991-4b13-9ce4-2b0370581b4e",
      "name": "Send a message",
      "webhookId": "7249b7e2-924f-4a26-9286-77fe878e13ef",
      "credentials": {
        "gmailOAuth2": {
          "id": "DhSw4HHChVkjzWdk",
          "name": "Gmail account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "cd3ecda6-9659-4a31-9ddc-7dd93dc9e6ef",
              "leftValue": "",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        848,
        -400
      ],
      "id": "ce195558-0f8c-4245-b27d-571b3c0430d7",
      "name": "If1"
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "",
                    "rightValue": "",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "8e703ddb-0519-4025-807d-3a7d32d70282"
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.3,
      "position": [
        992,
        -640
      ],
      "id": "1ac6c352-0c1d-4366-89d6-9e37808e6995",
      "name": "Switch"
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "mode": "list",
          "value": ""
        },
        "sheetName": {
          "__rl": true,
          "mode": "list",
          "value": ""
        }
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        1296,
        -912
      ],
      "id": "997ecce2-b4f4-475a-9deb-a41baf675da0",
      "name": "Update row in sheet",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "uyTjJuwscBcWz4hf",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "mode": "list",
          "value": ""
        },
        "sheetName": {
          "__rl": true,
          "mode": "list",
          "value": ""
        }
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        1648,
        -912
      ],
      "id": "27520d20-eee2-4d54-9106-ce0373d80679",
      "name": "Append row in sheet",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "uyTjJuwscBcWz4hf",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        2192,
        -640
      ],
      "id": "009e5744-023d-4d61-a4fd-c476b74c8561",
      "name": "Send a message1",
      "webhookId": "fe4347eb-e60c-4b1c-811b-fc3e7d6459e5",
      "credentials": {
        "gmailOAuth2": {
          "id": "DhSw4HHChVkjzWdk",
          "name": "Gmail account"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "mode": "list",
          "value": ""
        },
        "sheetName": {
          "__rl": true,
          "mode": "list",
          "value": ""
        }
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        1296,
        -640
      ],
      "id": "23cd6177-b3b2-4e4e-a7a7-76baba5fb234",
      "name": "Update row in sheet1",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "uyTjJuwscBcWz4hf",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "mode": "list",
          "value": ""
        },
        "sheetName": {
          "__rl": true,
          "mode": "list",
          "value": ""
        }
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        1648,
        -640
      ],
      "id": "13a62fa4-d83d-4bb1-990f-6439af8ce718",
      "name": "Append row in sheet1",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "uyTjJuwscBcWz4hf",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "mode": "list",
          "value": ""
        },
        "sheetName": {
          "__rl": true,
          "mode": "list",
          "value": ""
        }
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        1312,
        -368
      ],
      "id": "5d05ef80-a58a-40b9-b34c-57491d2c78c8",
      "name": "Update row in sheet2",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "uyTjJuwscBcWz4hf",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "mode": "list",
          "value": ""
        },
        "sheetName": {
          "__rl": true,
          "mode": "list",
          "value": ""
        }
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        1632,
        -368
      ],
      "id": "e70b994e-7c2b-4107-9dc4-298b91fdaea3",
      "name": "Append row in sheet2",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "uyTjJuwscBcWz4hf",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        1232,
        -80
      ],
      "id": "61a7bbec-5220-4257-8cb9-6efb92a0b692",
      "name": "Send a message2",
      "webhookId": "1f0c58c4-ec95-451c-9542-87995af22647",
      "credentials": {
        "gmailOAuth2": {
          "id": "DhSw4HHChVkjzWdk",
          "name": "Gmail account"
        }
      }
    },
    {
      "parameters": {
        "path": "73ec021a-311a-4d58-beb3-4cd77302bb3f",
        "options": {}
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2.1,
      "position": [
        -16,
        -608
      ],
      "id": "a83828f6-5555-4c01-80c1-588573cdef02",
      "name": "Webhook",
      "webhookId": "73ec021a-311a-4d58-beb3-4cd77302bb3f"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "mode": "list",
          "value": ""
        },
        "sheetName": {
          "__rl": true,
          "mode": "list",
          "value": ""
        }
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        240,
        -608
      ],
      "id": "cadcb178-f361-414c-adbc-62c85d4762e5",
      "name": "Get row(s) in sheet1",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "uyTjJuwscBcWz4hf",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "content": "## เช็คโควต้าการลาที่มีอยู่\n",
        "height": 256,
        "width": 528
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -80,
        -688
      ],
      "typeVersion": 1,
      "id": "d5ea1752-f7f1-4e06-a6a2-be227b8153e4",
      "name": "Sticky Note"
    },
    {
      "parameters": {
        "content": "## ตรวจสอบการอนุญาต ลาป่วย\n",
        "height": 208,
        "width": 544,
        "color": 4
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1248,
        -960
      ],
      "typeVersion": 1,
      "id": "c4c06aa0-793d-4440-bda8-a6034b8fe58f",
      "name": "Sticky Note1"
    },
    {
      "parameters": {
        "content": "## ตรวจสอบการอนุญาต ลากิจ\n\n",
        "height": 208,
        "width": 544,
        "color": 2
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1248,
        -688
      ],
      "typeVersion": 1,
      "id": "8c07753b-62c1-407b-9c79-ceb37c03102a",
      "name": "Sticky Note2"
    },
    {
      "parameters": {
        "content": "## ตรวจสอบการอนุญาต ลาพักร้อน\n\n",
        "height": 208,
        "width": 544,
        "color": 3
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1248,
        -416
      ],
      "typeVersion": 1,
      "id": "6a12c14a-8894-4ce6-8af8-c55e07824269",
      "name": "Sticky Note3"
    },
    {
      "parameters": {
        "content": "## ไม่อนุมัติ\n\n",
        "height": 224,
        "color": 3
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1184,
        -144
      ],
      "typeVersion": 1,
      "id": "69226dcd-63de-4b74-b310-1ef9200b3707",
      "name": "Sticky Note4"
    },
    {
      "parameters": {
        "content": "## ไม่มีโควต้าการลา\n\n",
        "height": 240,
        "width": 272,
        "color": 3
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        560,
        -48
      ],
      "typeVersion": 1,
      "id": "6ad97c2d-051d-4e63-9ff9-749c640166cd",
      "name": "Sticky Note5"
    },
    {
      "parameters": {
        "content": "## ตรวจสอบและพิจารณา\n",
        "height": 256,
        "width": 432,
        "color": 3
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        592,
        -464
      ],
      "typeVersion": 1,
      "id": "30114929-10eb-4685-93cd-57bce3463a49",
      "name": "Sticky Note6"
    },
    {
      "parameters": {
        "content": "## ส่งข้อความผ่านอีเมล ว่า อนุมัติ\n\n",
        "height": 224,
        "width": 352,
        "color": 3
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        2080,
        -704
      ],
      "typeVersion": 1,
      "id": "e26c428a-8425-46b0-8144-b58ce8c68f53",
      "name": "Sticky Note7"
    },
    {
      "parameters": {
        "content": "## ขออนุมัติ\n",
        "height": 256,
        "width": 736,
        "color": 4
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -192,
        -336
      ],
      "typeVersion": 1,
      "id": "2d381137-6d10-4d84-bfcb-ecda339a056b",
      "name": "Sticky Note8"
    }
  ],
  "pinData": {},
  "connections": {
    "On form submission": {
      "main": [
        [
          {
            "node": "Get row(s) in sheet",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet": {
      "main": [
        [
          {
            "node": "If",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If": {
      "main": [
        [
          {
            "node": "Send message and wait for response",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Send a message",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send message and wait for response": {
      "main": [
        [
          {
            "node": "If1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If1": {
      "main": [
        [
          {
            "node": "Switch",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Send a message2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch": {
      "main": [
        [
          {
            "node": "Update row in sheet1",
            "type": "main",
            "index": 0
          },
          {
            "node": "Update row in sheet",
            "type": "main",
            "index": 0
          },
          {
            "node": "Update row in sheet2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update row in sheet": {
      "main": [
        [
          {
            "node": "Append row in sheet",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Append row in sheet": {
      "main": [
        [
          {
            "node": "Send a message1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update row in sheet1": {
      "main": [
        [
          {
            "node": "Append row in sheet1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update row in sheet2": {
      "main": [
        [
          {
            "node": "Append row in sheet2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Append row in sheet1": {
      "main": [
        [
          {
            "node": "Send a message1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Append row in sheet2": {
      "main": [
        [
          {
            "node": "Send a message1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Webhook": {
      "main": [
        [
          {
            "node": "Get row(s) in sheet1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "c94b08d8-a996-418f-b0f6-f0d348113654",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "e1787d6e4dcf9ac0870df4648d9ad9a5be3564902a522b222db90c25aae9fdfd"
  },
  "id": "1lhXQnFBCLGOi4HD",
  "tags": []
}